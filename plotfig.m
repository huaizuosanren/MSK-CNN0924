% ebno=-20:0;
% figure(1)
% a0=[0.318000000000000,0.297000000000000,0.311000000000000,0.271000000000000,0.240000000000000,0.230000000000000,0.201000000000000,0.175000000000000,0.154000000000000,0.102000000000000,0.0960000000000000,0.0820000000000000,0.0560000000000000,0.0400000000000000,0.0375000000000000,0.0186666666666667,0.00814285714285714,0.00530000000000000,0.00283333333333333,0.00116279069767442];
% a1=[0.356000000000000	0.328000000000000	0.286000000000000	0.279000000000000	0.266000000000000	0.222000000000000	0.212000000000000	0.165000000000000	0.156000000000000	0.135000000000000	0.101000000000000	0.0810000000000000	0.0510000000000000	0.0320000000000000	0.0190000000000000	0.00600000000000000	0.00400000000000000	0.00200000000000000	0.00100000000000000];
% a2=[0.363000000000000	0.316000000000000	0.311000000000000	0.317000000000000	0.276000000000000	0.260000000000000	0.232000000000000	0.234000000000000	0.172000000000000	0.155000000000000	0.140000000000000	0.114000000000000	0.0820000000000000	0.0590000000000000	0.0485000000000000	0.0380000000000000	0.0216666666666667	0.0137500000000000	0.0125000000000000	0.00728571428571429	0.00662500000000000];
% a3=[0.429000000000000	0.408000000000000	0.374000000000000	0.379000000000000	0.359000000000000	0.339000000000000	0.341000000000000	0.329000000000000	0.298000000000000	0.259000000000000	0.248000000000000	0.227000000000000	0.185000000000000	0.159000000000000	0.136000000000000	0.126000000000000	0.104000000000000	0.0790000000000000	0.0640000000000000 0.0450000000000000	0.0415000000000000	0.0340000000000000 0.0280000000000000	0.0275000000000000	0.0147500000000000	0.0128000000000000	0.00966666666666667];
% a4=[0.424000000000000	0.440000000000000	0.433000000000000	0.424000000000000	0.453000000000000	0.403000000000000	0.424000000000000	0.403000000000000	0.356000000000000	0.399000000000000	0.355000000000000	0.344000000000000	0.306000000000000	0.298000000000000	0.270000000000000	0.259000000000000	0.241000000000000	0.202000000000000	0.181000000000000	0.160000000000000	0.135000000000000	0.125000000000000	0.110000000000000	0.0650000000000000	0.0595000000000000	0.0540000000000000	0.0510000000000000];
% a5=[0.483000000000000	0.467000000000000	0.442000000000000	0.459000000000000	0.438000000000000	0.447000000000000	0.448000000000000	0.436000000000000	0.411000000000000	0.406000000000000	0.370000000000000	0.370000000000000	0.357000000000000	0.342000000000000	0.345000000000000	0.314000000000000	0.284000000000000	0.295000000000000	0.252000000000000	0.241000000000000	0.223000000000000	0.174000000000000	0.164000000000000	0.119000000000000	0.0960000000000000	0.0960000000000000	0.0670000000000000	0.0600000000000000	0.0445000000000000	0.0360000000000000	0.0275000000000000];
% semilogy(-15:4,a0,'-',-15:3,a1,'-d',-15:5,a2,'-s',-15:11,a3,'-*',-15:11,a4,'-o',-15:15,a5,'-^');hold on;
% grid on;
% legend('高斯','0','0.01','0.1','0.5','1');
% title('脉冲噪声与梳状干扰混合');
% ylabel('BER');
% xlabel('Eb/n0 (dB)');


% ebno=0:20;
% figure(1)
% a1=[0.432666666666667	0.438666666666667	0.425000000000000	0.414333333333333	0.410333333333333	0.380666666666667	0.378666666666667	0.349000000000000	0.344666666666667	0.331500000000000	0.317750000000000	0.296000000000000	0.264250000000000	0.252250000000000	0.225000000000000	0.194666666666667	0.186333333333333	0.172000000000000	0.147142857142857	0.129875000000000	0.110600000000000];
% a2=[0.455333333333333	0.422000000000000	0.418000000000000	0.389333333333333	0.400333333333333	0.375666666666667	0.376333333333333	0.353333333333333	0.339333333333333	0.320500000000000	0.308500000000000	0.284000000000000	0.270250000000000	0.251800000000000	0.220000000000000	0.203400000000000	0.185333333333333	0.169333333333333	0.140500000000000	0.132750000000000	0.113222222222222];
% a3=[0.402666666666667	0.402666666666667	0.398333333333333	0.391666666666667	0.356000000000000	0.356333333333333	0.347666666666667	0.323500000000000	0.305000000000000	0.277500000000000	0.263500000000000	0.244200000000000	0.218400000000000	0.194666666666667	0.162571428571429	0.150857142857143	0.129250000000000	0.108000000000000	0.0920000000000000	0.0807692307692308	0.0668000000000000];
% a4=[0.404666666666667	0.400000000000000	0.363000000000000	0.366333333333333	0.357333333333333	0.345333333333333	0.325750000000000	0.302500000000000	0.282000000000000	0.264000000000000	0.255500000000000	0.222200000000000	0.203000000000000	0.179000000000000	0.163428571428571	0.142000000000000	0.129875000000000	0.104100000000000	0.0922727272727273	0.0773846153846154	0.0635000000000000];
% a5=[3.571777e-01 3.445231e-01 3.320719e-01  3.070475e-01  2.927246e-01  2.723389e-01 2.444661e-01 2.149251e-01  1.983236e-01  1.625163e-01  1.451416e-01  1.232503e-01  1.070557e-01  8.024089e-02  7.629395e-02  5.741374e-02  4.809570e-02  3.792318e-02  2.628581e-02  2.327474e-02  1.810710e-02];
% a6=[3.435059e-01 3.291016e-01 3.198242e-01  2.983398e-01  2.822266e-01  2.583008e-01  2.351074e-01 2.038574e-01  1.931152e-01  1.584473e-01  1.403809e-01  1.181641e-01  1.032715e-01  7.714844e-02  7.446289e-02  5.541992e-02  4.736328e-02  3.564453e-02  2.490234e-02  2.282715e-02  1.757813e-02];
% semilogy(ebno,a1,'-d',ebno,a2,'-^',ebno,a3,'-*',ebno,a4,'-o',ebno,a5,'-^',ebno,a6,'-s');hold on;
% grid on;
% legend('采样判决','限幅器','中值滤波','积分判决','神经网络','多神经网络');
% title('脉冲噪声\alpha=1.2');
% ylabel('BER');
% xlabel('Eb/n0 (dB)');
% %============================
% ebno=0:20;
% figure(2)
% b1=[0.337000000000000	0.288000000000000	0.280000000000000	0.238000000000000	0.227000000000000	0.191000000000000	0.167000000000000	0.168000000000000	0.133000000000000	0.131000000000000	0.0875000000000000	0.0715000000000000	0.0710000000000000	0.0555000000000000	0.0393333333333333	0.0350000000000000	0.0242000000000000	0.0188333333333333	0.0180000000000000	0.0140000000000000	0.0131250000000000];
% b2=[0.314250000000000	0.290500000000000	0.267000000000000	0.249000000000000	0.224600000000000	0.213000000000000	0.185833333333333	0.154285714285714	0.128375000000000	0.111444444444444	0.0952727272727273	0.0720000000000000	0.0635000000000000	0.0524500000000000	0.0384444444444445	0.0318125000000000	0.0294117647058824	0.0215531914893617	0.0179107142857143	0.0154000000000000	0.0127125000000000];
% b3=[0.251000000000000	0.216000000000000	0.218000000000000	0.175000000000000	0.155000000000000	0.137000000000000	0.123000000000000	0.0800000000000000	0.0780000000000000	0.0490000000000000	0.0435000000000000	0.0305000000000000	0.0265000000000000	0.0193333333333333	0.0177500000000000	0.0110000000000000	0.00900000000000000	0.00625000000000000	0.00675000000000000	0.00450000000000000	0.00340000000000000];
% b4=[0.234000000000000	0.200000000000000	0.193000000000000	0.160000000000000	0.135000000000000	0.109000000000000	0.122000000000000	0.0780000000000000	0.0580000000000000	0.0530000000000000	0.0355000000000000	0.0280000000000000	0.0210000000000000	0.0183333333333333	0.0142500000000000	0.00933333333333333	0.00700000000000000	0.00472727272727273	0.00510000000000000	0.00416666666666667	0.00305882352941177];
% b5=[2.039063e-01 1.777100e-01 1.478760e-01 1.186279e-01 9.965820e-02 7.739258e-02 5.332031e-02  4.797363e-02 3.359375e-02 2.397461e-02 1.811523e-02 1.525879e-02 8.666992e-03 6.933594e-03 5.338542e-03 4.089355e-03 3.356934e-03 1.782227e-03 1.748657e-03 1.748739e-03  1.151925e-03];
% b6=[2.016602e-01 1.750488e-01 1.479492e-01 1.157227e-01 9.741211e-02 7.666016e-02 5.053711e-02  4.614258e-02 3.173828e-02 2.319336e-02 1.660156e-02 1.513672e-02 8.422852e-03 6.469727e-03 5.289714e-03 3.991699e-03 3.356934e-03 1.678467e-03 1.647949e-03 1.640837e-03  1.134119e-03];
% semilogy(ebno,b1,'-d',ebno,b2,'-^',ebno,b3,'-*',ebno,b4,'-o',ebno,b5,'-^',ebno,b6,'-s');hold on;
% grid on;
% legend('采样判决','限幅器','中值滤波','积分判决','神经网络','多神经网络');
% title('脉冲噪声\alpha=1.5');
% ylabel('BER');
% xlabel('Eb/n0 (dB)');
% %==============================
% ebno=-5:8;
% figure(3)
% a1=[0.189000000000000	0.192000000000000	0.119000000000000	0.129000000000000	0.101000000000000	0.0810000000000000	0.0510000000000000	0.0370000000000000	0.0232000000000000	0.0103000000000000	0.00526315789473684	0.00196000000000000	0.000600000000000000	0.000140000000000000];
% a2=[0.196000000000000	0.172000000000000	0.161000000000000	0.116000000000000	0.0930000000000000	0.0760000000000000	0.0456666666666667	0.0343333333333333	0.0193333333333333	0.00909090909090909	0.00530000000000000	0.00204081632653061	0.000460000000000000	0.000100000000000000];
% a3=[0.141000000000000	0.0920000000000000	0.0835000000000000	0.0500000000000000	0.0376666666666667	0.0234000000000000	0.0131250000000000	0.00673333333333333	0.00243902439024390	0.000960000000000000	0.000280000000000000	4.00000000000000e-05	0	0];
% a4=[0.103000000000000	0.0615000000000000	0.0685000000000000	0.0420000000000000	0.0252500000000000	0.0165714285714286	0.0126250000000000	0.00625000000000000	0.00288888888888889	0.00106000000000000	0.000360000000000000	6.00000000000000e-05 0 0];
% % a5=[9.191895e-02 6.967773e-02 5.297852e-02 3.664551e-02 2.253418e-02 1.336263e-02 7.978516e-03 3.708496e-03 1.916155e-03 8.178711e-04 2.851562e-04 9.228516e-05 0 0];
% a5=[8.251953e-02	6.787109e-02	4.638672e-02	2.612305e-02	1.684570e-02	1.074219e-02	3.784180e-03	1.953125e-03	9.416853e-04	2.728631e-04	3.629117e-05	7.324219e-06 0 0];
% a6=[7.739258e-02 5.249023e-02 4.199219e-02 2.221680e-02 1.220703e-02 5.859375e-03 2.929688e-03 7.812500e-04 2.092634e-04 4.394531e-05 0 0 0 0];
% semilogy(ebno,a1,'-d',ebno,a2,'-^',ebno,a3,'-*',ebno,a4,'-o',ebno,a5,'-^',ebno,a6,'-s');hold on;
% grid on;
% legend('采样判决','限幅器','中值滤波','积分判决','神经网络','多神经网络');
% title('高斯噪声\alpha=2');
% ylabel('BER');
% xlabel('Eb/n0 (dB)');
% %==========================
% ebno=-5:15;
% figure(4)
% a1=[0.194000000000000	0.179000000000000	0.147000000000000	0.123000000000000	0.124000000000000	0.0670000000000000	0.0740000000000000	0.0370000000000000	0.0290000000000000	0.0280000000000000	0.0223333333333333	0.0170000000000000	0.0127500000000000	0.00983333333333333	0.00728571428571429	0.00728571428571429	0.00675000000000000	0.00588888888888889	0.00384615384615385	0.00312500000000000	0.00236363636363636];
% a2=[0.184000000000000	0.160000000000000	0.140000000000000	0.128000000000000	0.105000000000000	0.0670000000000000	0.0520000000000000	0.0465000000000000	0.0280000000000000	0.0243333333333333	0.0193333333333333	0.0170000000000000	0.0147500000000000	0.0100000000000000	0.00866666666666667	0.00757142857142857	0.00454545454545455	0.00463636363636364	0.00425000000000000	0.00392857142857143	0.00250000000000000];
% a3=[0.100000000000000	0.0630000000000000	0.0590000000000000	0.0420000000000000	0.0290000000000000	0.0240000000000000	0.0186666666666667	0.0127500000000000	0.00900000000000000	0.00785714285714286	0.00560000000000000	0.00454545454545455	0.00392857142857143	0.00238095238095238	0.00178571428571429	0.00156250000000000	0.00138888888888889	0.00119047619047619	0.00100000000000000	0.000760000000000000	0.000700000000000000];
% a4=[0.0810000000000000	0.0540000000000000	0.0500000000000000	0.0415000000000000	0.0256666666666667	0.0193333333333333	0.0137500000000000	0.00966666666666667	0.00725000000000000	0.00675000000000000	0.00333333333333333	0.00300000000000000	0.00273684210526316	0.00166666666666667	0.00217391304347826	0.00125000000000000	0.000740000000000000	0.000720000000000000	0.000880000000000000 0 0];
% a5=[6.293945e-02 4.934082e-02 3.730469e-02 2.578125e-02 1.787109e-02 1.315918e-02 1.174316e-02 7.482910e-03 5.143229e-03 3.735352e-03 2.716064e-03 2.044678e-03 1.782227e-03 1.159668e-03 0 0 0 0 0 0 0];
% a6=[5.639648e-02 4.296875e-02 3.344727e-02 2.294922e-02 1.416016e-02 1.123047e-02 8.789063e-03 6.835938e-03 4.069010e-03 3.092448e-03 2.075195e-03 1.831055e-03 1.342773e-03 9.460449e-04 0 0 0 0 0 0 0];
% semilogy(ebno,a1,'-d',ebno,a2,'-^',ebno,a3,'-*',ebno,a4,'-o',ebno,a5,'-^',ebno,a6,'-s');hold on;
% grid on;
% legend('采样判决','限幅器','中值滤波','积分判决','神经网络','多神经网络');
% title('脉冲和梳状干扰混合');
% ylabel('BER');
% xlabel('Eb/n0 (dB)');

% ==============================

% figure(1)
% x = -10:.1:10;
% beta = 0;
% gam = 1;
% delta = 0;
% plot(x , stblpdf(x,1,beta,gam,delta,'quick'),...
%   x , stblpdf(x,1.2,beta,gam,delta,'quick'),...
%   x , stblpdf(x,1.5,beta,gam,delta,'quick'),...
%   x , stblpdf(x,1.9,beta,gam,delta,'quick'),...
%   x , stblpdf(x,2,beta,gam,delta,'quick') );
% 
% % axis([-5 5 0 .7]);
% title('对称 \alpha-stable 概率密度曲线, \beta = 0, \gamma = 1, \delta = 0');
% legend('\alpha = 1',...
%     '\alpha = 1.2',...
%     '\alpha = 1.5',...
%     '\alpha = 1.9',...
%     '\alpha = 2.0' )

% subplot(221)
% SNR=1;%0dB
% alpha=2;
% S0=1/(sqrt(2*1.78*SNR*1));
% gamma=((1.78*S0)^alpha)/1.78;
% delta=gamma^(1/alpha)
% pulsenoise = stblrnd(alpha,0,delta,0,[1,4000]);
% plot(pulsenoise);
% xlabel('采样点数');
% ylabel('脉冲幅值');
% title('\alpha = 2')
% 
% subplot(222)
% SNR=1;%0dB
% alpha=1.9;
% S0=1/(sqrt(2*1.78*SNR*1));
% gamma=((1.78*S0)^alpha)/1.78;
% delta=gamma^(1/alpha)
% pulsenoise = stblrnd(alpha,0,delta,0,[1,4000]);
% plot(pulsenoise);
% xlabel('采样点数');
% ylabel('脉冲幅值');
% title('\alpha = 1.9')
% 
% subplot(223)
% SNR=1;%0dB
% alpha=1.5;
% S0=1/(sqrt(2*1.78*SNR*1));
% gamma=((1.78*S0)^alpha)/1.78;
% delta=gamma^(1/alpha)
% pulsenoise = stblrnd(alpha,0,delta,0,[1,4000]);
% plot(pulsenoise);
% xlabel('采样点数');
% ylabel('脉冲幅值');
% title('\alpha = 1.5')
% 
% subplot(224)
% SNR=1;%0dB
% alpha=1.2;
% S0=1/(sqrt(2*1.78*SNR*1));
% gamma=((1.78*S0)^alpha)/1.78;
% delta=gamma^(1/alpha)
% pulsenoise = stblrnd(alpha,0,delta,0,[1,4000]);
% plot(pulsenoise);
% xlabel('采样点数');
% ylabel('脉冲幅值');
% title('\alpha = 1.2')
figure;
snr=0;snr=10.^(snr/10);N2=1/snr;N=10000;fi=20000;fs=80000;
% noise2=sqrt(N2)*rand(1,N).*cos(2*pi*(fi)*(1:N)/fs)-...
%        sqrt(N2)*rand(1,N).*sin(2*pi*(fi)*(1:N)/fs)+...
%        sqrt(N2)*rand(1,N).*cos(2*pi*(fi-4000)*(1:N)/fs)-...
%        sqrt(N2)*rand(1,N).*sin(2*pi*(fi-4000)*(1:N)/fs)+...
%        sqrt(N2)*rand(1,N).*cos(2*pi*(fi+4000)*(1:N)/fs)-...
%        sqrt(N2)*rand(1,N).*sin(2*pi*(fi+4000)*(1:N)/fs)+... 
%        sqrt(N2)*rand(1,N).*cos(2*pi*(fi-8000)*(1:N)/fs)-...
%        sqrt(N2)*rand(1,N).*sin(2*pi*(fi-8000)*(1:N)/fs)+...
%        sqrt(N2)*rand(1,N).*cos(2*pi*(fi+8000)*(1:N)/fs)-...
%        sqrt(N2)*rand(1,N).*sin(2*pi*(fi+8000)*(1:N)/fs)+...
%        sqrt(N2)*rand(1,N).*cos(2*pi*(fi-12000)*(1:N)/fs)-...
%        sqrt(N2)*rand(1,N).*sin(2*pi*(fi-12000)*(1:N)/fs)+...
%        sqrt(N2)*rand(1,N).*cos(2*pi*(fi+12000)*(1:N)/fs)-...
%        sqrt(N2)*rand(1,N).*sin(2*pi*(fi+12000)*(1:N)/fs);

noise2=sqrt(N2)*rand(1,N).*cos(2*pi*(fi)*(1:N)/fs)-...
       sqrt(N2)*rand(1,N).*sin(2*pi*(fi)*(1:N)/fs);

  subplot(211)
   plot((1:N)/fs,noise2);
   axis([0 0.12 -10 10]);
   xlabel('时间/s');
 ylabel('幅值');
 title('时域图像')
  subplot(212)
   fftnoise2=abs(fft(noise2));
   plot((0:N/2)*fs/N,fftnoise2(1:N/2+1)); 
 xlabel('频率/Hz');
 ylabel('幅值');
 title('频域图像')










